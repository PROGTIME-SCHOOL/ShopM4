@using ShopM4_Utility
@model IEnumerable<Product>

<h1>Shooping Cart</h1>

<p><a class="btn btn-primary" asp-controller="Home">Continue Shopping</a></p>


@if (Model.Count() > 0)
{
    <form method="post" asp-action="Summary">

        @{
            double totalPriceProducts = 0;
        }

        @foreach (var item in Model)
        {
            <p>
                <img src="@PathManager.ImageProductPath@item.Image" width="100" class="rounded" />
            </p>

            <p>
                Product Name: @item.Name
            </p>

            <p>
                Description: @item.ShortDescription
            </p>

            <p>
                Price: @item.Price
            </p>

            @if (User.IsInRole(PathManager.AdminRole))
            {
                <p>
                    Count:
                    <input type="text" asp-for="@item.TempCount" class="form-control" />
                </p>

                <p>
                    Total Price: @(item.TempCount * item.Price)
                </p>

                totalPriceProducts += item.TempCount * item.Price;
            }

            <p>
                <a class="btn btn-danger" asp-action="Remove" asp-route-Id="@item.Id">
                    TRASH
                </a>
            </p>
        }


        @if (User.IsInRole(PathManager.AdminRole))
        {
            <h2>Total: @totalPriceProducts</h2>

            <input type="submit" value="Update Cart" class="btn btn-info form-control"
                   asp-action="Update" />
        }


        <p>
            <button type="submit" class="btn btn-success">
                Continue
            </button>
        </p>

    </form>
}
else
{
    <p>Cart is emty</p>
}

